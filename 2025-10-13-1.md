- ## Full Incident Report

  ### Summary

  - **CA Owner CCADB unique ID:**

    SHECA（A000261）

  - **Incident description:**

    According to the third-party notification, which is the final discussion result of the Google forum, the following three APIs provided by SHECA to its partners violate some regulations of BR. SHECA will revoke all involved certificates within five days in accordance with Baseline Requirements.

    /openApi/v1/order/getCertInfo
    Function: Download certificates in all formats
    Subscriber-provided parameters: Private key and order number
    SHECA returns: An encrypted ZIP file containing certificates in various formats, including Nginx, Tomcat, and Apache.

    /open-api/v2/order/download-zip
    Function: Download certificates in all formats
    Subscriber-provided parameters: Private key and order number
    SHECA returns: An encrypted ZIP file containing certificates in various formats, including Nginx, Tomcat, and Apache.

    /open-api/v2/tools/gen-csr
    Function: Generate a certificate request (CSR)
    Subscriber-provided parameters: None
    SHECA returns: Certificate request (CSR) and private key.

See the thread at for more details.
https://groups.google.com/a/mozilla.org/g/dev-security-policy/c/sAHY8ZjBPhM/m/S81E2WFlAgAJ 

  - **Timeline summary:**

    - **Non-compliance start date:** 2023-05-30
    - **Non-compliance identified date:** 2025-10-07
    - **Non-compliance end date:** 2025-10-09

  - **Relevant policies:**

    **BR 6.1.1.3:**
    "If the Subscriber Certificate will contain an extKeyUsage extension containing either the values id-kp-serverAuth [RFC5280] or anyExtendedKeyUsage [RFC5280], the CA SHALL NOT generate a Key Pair on behalf of a Subscriber, and SHALL NOT accept a certificate request using a Key Pair previously generated by the CA."

    **BR 9.6.3:**
    "The Applicant is obligated and warrants to take all reasonable measures to ensure control, confidentiality, and proper protection at all times of the private key corresponding to the public key included in the requested Certificate (as well as any related activation data or devices, such as passwords or tokens);"

    **BR 4.9.1.1**
“With the exception of Short-lived Subscriber Certificates, the CA SHOULD revoke a certificate within 24 hours and MUST revoke a Certificate within 5 days and use the corresponding CRLReason (see Section 7.2.2) if one or more of the following occurs: 
16. The CA is made aware of a demonstrated or proven method that exposes the Subscriber's Private Key to compromise or if there is clear evidence that the specific method used to generate the Private Key was flawed (CRLReason #1, keyCompromise).”

  - **Source of incident disclosure:**

    Third party reported

  - ### **Impact**

    - **Total number of certificates:** 18838

    - **Total number of "remaining valid" certificates:** 7177

    - **Affected certificate types:** OV-TLS (OID:2.23.140.1.2.2) and DV-TLS (OID:2.23.140.1.2.1）

    - **Incident heuristic:**  

    - **Was issuance stopped in response to this incident?**

    SHECA has not ceased certificate issuance. SHECA has informed the two invloved partners that all certificates issued before the deactivation of the aforementioned interfaces (by 23:59:59 UTC+8 on October 9, 2025) will be revoked. This is because the private keys of these certificates may all have been transmitted to SHECA's server via the interfaces.

    - **Analysis:** 

      The scope of certificates affected by this incident includes all valid certificates issued through the three interfaces by 23:59:59 UTC+8 on October 9, 2025.

      **Xinnet：**

      All valid certificates issued under the two ICAs (UCA Global G2 Root - Xinnet DV SSL and UCA Global G2 Root - Xinnet OV SSL) by 23:59:59 UTC+8 on October 9, 2025.

    ​**China Mobile Cloud：**

    ​All valid certificates issued under China Mobile Cloud accounts by 23:59:59 UTC+8 on October 9, 2025.

    - **Additional considerations:** 

      Not applicable.

    ------

    ### **Timeline** 

    **All timestamps are Beijing time (UTC+8)**   
2025-10-02 20:35: SHECA received a message in the MSDP discussion group regarding the online tool it provides to subscribers for generating CSRs and private keys.
2025-10-04 05:42: SHECA obtained an initial response stating that if the relevant functions are implemented using JavaScript on the front-end interface and the CA itself does not access subscribers' private keys, this does not violate BR regulations. The community informed SHECA that there might be some issues with its current implementation code and provided professional rectification suggestions. SHECA has already started rectifying the relevant code, and the progress will be synchronized as a rectification item in this case.
2025-10-06 06:57: SHECA received a notification indicating that the open APIs have accessed private keys, which may violate BR regulations. SHECA immediately launched an internal investigation to confirm the situation, identified BR violations, and promptly arranged for the offline deployment of the relevant APIs.
2025-10-08 20:35: SHECA committed in the forum that it would revoke the affected certificates within the next five days according to the revocation timeframe in BR.
2025-10-10 08:49: SHECA received a case notification from Bugzilla.
2025-10-09 24:59: All three APIs have been taken offline, and subscribers have been notified that all certificates involved in this event will be revoked by 20:35 on October 13, 2025.
2025-10-11 10:00: The automated re-issuance of certificates for Xinnet's subscribers who support this function was completed, and relevant subscribers were notified to replace their certificates within 24 hours.

      

    ------

    ### Related Incidents

    | Bug                                                          | Date       | Description                                                  |
    | ------------------------------------------------------------ | ---------- | ------------------------------------------------------------ |
    | [1699756](https://bugzilla.mozilla.org/show_bug.cgi?id=1699756) | 2021-03-31 | 该 Bug 记录了 2021 年 Mozilla 社区对 Sectigo 旗下经销商 ZeroSSL 的私钥生成与存储流程是否违反 Mozilla 根证书政策的合规审查事件。经技术验证与多方沟通，最终确认 ZeroSSL 流程符合政策要求，Bug 状态定为 “RESOLVED INVALID”（无效）。 |  
  Root Cause Analysis
Contributing Factor #1: Inadequate Pre-launch Compliance Review Mechanism for API Products
Description: The three problematic APIs were launched in 2023 (consistent with the non-compliance start date of 2023-05-30) but lacked a comprehensive BR compliance review process before launch. The pre-launch review only focused on functional realization and ignored compliance with core BR clauses related to private key management.
Timeline: The API design phase (Q1 2023) lacked compliance review; the APIs were formally launched in May 2023 (2023-05-30, the start date of non-compliance) and operated without correction until October 2025 when the violation was identified.
Detection: Discovered by a third party and reported via the Google forum.
Interaction with other factors: This factor is the root cause of the incident. Without pre-launch compliance review, the API’s inherent non-compliance was not addressed, creating a long-term security loophole. Subsequent operational monitoring failures further allowed the violation to persist.
Contributing Factor #2: Incomplete Internal Inspection with Room for Coverage Improvement
Description: SHECA maintained regular internal inspections and self-assessments of certificate service processes, but there were blind spots in the coverage of API parameter design and private key flow tracking. In previous inspections, the focus was mainly on the CA system, RA system, and order systems—covering key links such as certificate issuance processes, data storage, and access control. The APIs involved in this incident were not included in the regular inspection framework, and they were not subject to in-depth compliance analysis and verification, forming a compliance blind spot.
Timeline: From the API launch in May 2023 to the offline deployment in October 2025, internal inspections did not cover the aforementioned API compliance details.
Detection: The gaps were identified through internal investigation after receiving third-party notifications, prompting SHECA to recognize the need to improve inspection comprehensiveness.
Interaction with other factors: This factor prolonged the duration of the incident. Even though the pre-launch review had potential gaps, a more comprehensive internal inspection could have identified and addressed the issues earlier, reducing the number of affected certificates and the scope of impact.
Contributing Factor #3: Insufficient Professional Training on BR for Technical and Product Teams
Description: The technical team responsible for API development and the product team responsible for requirement definition had insufficient understanding of BR clauses related to private key management. 
Timeline: During 2023 to 2025, no systematic BR training was conducted for technical or product teams.
Detection: Revealed during the internal investigation after the incident.
Interaction with other factors: This factor laid the foundation for the incident. Inadequate team knowledge led to both the flawed API design (Contributing Factor 1) and the failure to detect issues during operation (Contributing Factor 2). Without a solid understanding of BR, the teams could not proactively identify or address compliance risks.
Root Cause Analysis Methodology Used
This analysis adopts the Root Cause Tree Analysis and Process Review Method to systematically trace the causes of the incident:
.Root Cause Tree Analysis:
Starting from the "API non-compliance with BR" incident, trace down to direct causes (API design not aligning with BR, internal inspection not covering key points) and underlying causes (incomplete review framework, insufficient inspection coverage, inadequate team knowledge).
Classify causes into "process", "system", and "personnel" dimensions to ensure no gaps in analysis.	
.Process Review Method:
Review the entire lifecycle of the three APIs (design, launch, operation, offline) to identify compliance management weaknesses in each phase.
Compare the actual operation process with industry best practices to find room for optimization.
Through the combination of these two methods, the core causes of the incident were identified as: the need to optimize the pre-launch compliance review framework, incomplete internal inspection coverage (especially for partner interfaces), and the need to enhance team BR knowledge updates—all of which are areas that SHECA can proactively improve through targeted measures.

Lessons Learned
What went well
.Rapid emergency response: After receiving the third-party notification on October 6, SHECA immediately activated the emergency response mechanism, completed the internal investigation within a short time, confirmed the situation, and took the APIs offline by October 9—effectively preventing the expansion of potential risks and demonstrating event response capabilities.
.Proactive compliance with BR requirements: On October 8, SHECA publicly committed to revoking affected certificates within five days in the forum, following the revocation timeframe specified in BR 4.9.1.1, and fully fulfilling its obligations as a CA to ensure subscriber security.
.Efficient subscriber support: By October 11, SHECA completed the automated re-issuance of certificates for Xinnet’s subscribers and provided timely notifications and technical guidance for certificate replacement, minimizing the impact of the incident on subscribers’ normal business operations.
.Open communication with the community: Throughout the incident, SHECA maintained active communication with the community and third parties, timely feedback on progress, and demonstrated a positive attitude toward addressing issues and optimizing services.
What didn’t go well
During the National Day holiday (October 1st - October 8th), as the team conducted the first round of inspection through remote collaboration, due to the limitations of resource allocation and remote communication efficiency during the holiday, only two APIs was detected. On the first working day after the holiday (October 9th), the last API was detected through a comprehensive inspection of all logs.
Where we got lucky
.No actual private key leakage incident reported: Although the APIs had the risk of private key transmission to the server, no subscriber reported actual private key leakage or security incidents caused by this issue.
.Smooth coordination with partners: During the incident handling process, partners actively cooperated with SHECA’s certificate revocation and re-issuance work, ensuring the efficient advancement of risk mitigation measures.
.Automated certificate issuance capabilities: SHECA’s existing automated certificate re-issuance system operated stably, enabling rapid completion of automated re-issuance work and reducing the impact on subscribers.
Action Items
Action Item	Kind	Corresponding Root Cause(s)	Evaluation Criteria	Due Date	Status
Optimize the pre-launch compliance review for products and services involving certificate services.	Process Optimization	Factor 1	The optimized review framework document is formally released.	2025-10-31	Pending
Establish a quarterly internal audit mechanism for certificate service APIs.	Process Optimization	Factor 2 	The quarterly internal audit work plan is formulated and released.	2025-10-31	Pending
Launch a "BR Training Program" for technical and product personnels, targeting detailed regulations.	Team Capacity Building	Factor 3	The training plan is completed and released. Training is conducted.	2025-07-01: the plan is in palce. 
The training is conducted quarterly.	In progress
