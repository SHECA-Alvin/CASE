## Incident Report

### Summary

SHECA issued a new intermediate root certificate for its partner and configured new certificate products. However, due to an operator error, when issuing DV SSL certificates under the intermediate root **Keymatic Secure Domain ECC CA G1**, the DV SSL certificate product was incorrectly linked to the OV SSL certificate template. Additionally, because the whitelist did not include the corresponding product code, the pre-issuance linting process failed, resulting in the issued certificates having the **certificatePolicies** extension containing the OID for OV certificates. Furthermore, the certificates' DN only included the **CN** and **C** attributes.

### Impact

The following three certificates contained formatting errors and have all been revoked per customer requests:

- [Certificate 1](https://crt.sh/?id=16556132396)  
- [Certificate 2](https://crt.sh/?id=16546315389)  
- [Certificate 3](https://crt.sh/?id=16535669659)  

### Timeline

All times are in UTC+8.

**2025-01-05**:  
- **15:00** SHECA issued a new custom intermediate root, Keymatic Secure Domain ECC CA G1, for its partner.

**2024-01-24**:  
- **21:00** A new DV SSL certificate product was added. The CA system operator configured the certificate template for the new intermediate root (Keymatic Secure Domain ECC CA G1) and refreshed the cache to activate the template.

**2024-02-05**:  
- **15:00** A subscriber requested ECC algorithm certificates, resulting in the issuance of three certificates.

**2024-02-07**:  
- **17:21** SHECA’s compliance team received an alert indicating formatting issues in three DV certificates issued by Keymatic Secure Domain ECC CA G1. The alert was generated by the weekly linting task, which checks all unrevoked certificates every Friday and reports any issues.  
- **17:30** The compliance team notified the business team to stop issuing certificates under Keymatic Secure Domain ECC CA G1.  
- **23:44** SHECA received a third-party email notification regarding certificate formatting issues, which were confirmed to match the previously identified certificates.

**2024-02-10**:  
- **10:02** A CA system operator discovered that the DV SSL certificate product associated with Keymatic Secure Domain ECC CA G1 was incorrectly configured to reference the OV SSL certificate template.  
- **10:10** The operator rechecked all certificate product configurations and confirmed no other templates had similar issues.  
- **10:40** The operator reconfigured the certificate product template associated with Keymatic Secure Domain ECC CA G1 to the DV SSL template and refreshed the cache.  
- **11:00** SHECA investigated why pre-issuance linting was not performed. SHECA, in compliance with BR requirements, performs linting on certificates before signing them.  
- **15:01** It was determined that pre-issuance linting failed because the product code for the DV SSL certificate associated with Keymatic Secure Domain ECC CA G1 was not included in the whitelist used to trigger linting.

### Root Cause Analysis

**Reason 1**  
The CA system operator mistakenly linked the DV SSL certificate product associated with Keymatic Secure Domain ECC CA G1 to the OV SSL certificate template.  

**Reason 2**  
SHECA uses a whitelist to specify which certificate products require pre-issuance linting. However, after adding the new product, the relevant product code was not added to the whitelist due to a lack of communication, rendering the pre-issuance linting ineffective and failing to prevent the erroneous issuance.

### Lessons Learned

#### What went well  
- SHECA’s scheduled linting task for all unrevoked certificates promptly identified the issue.

#### What didn’t go well  
- The configuration of certificate templates lacked a secondary review mechanism.  
- The process for adding new products was not standardized.  

#### Where we got lucky  
- Not applicable.

### Action Items

| Action Item                                                                 | Kind    | Due Date   |
|-----------------------------------------------------------------------------|---------|------------|
| Standardize the process for adding new products to include adding product codes to the linting whitelist as a required step. | Prevent | 2025-02-30 |
| Implement a secondary review mechanism for certificate template configurations. Templates must be reviewed and approved by an auditor after operator configuration before activation. | Prevent | 2025-02-30 |

### Appendix

- [Certificate 1](https://crt.sh/?id=16556132396)  
- [Certificate 2](https://crt.sh/?id=16546315389)  
- [Certificate 3](https://crt.sh/?id=16535669659)  
